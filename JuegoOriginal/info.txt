Este es el codigo original sin modularizar, aca se encuentra todo funcional, pero sin modularizacion.
